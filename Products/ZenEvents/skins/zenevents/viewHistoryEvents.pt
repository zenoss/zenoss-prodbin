<tal:block metal:use-macro="here/templates/macros/page2">
<tal:block metal:fill-slot="contentPane">
<span metal:define-macro="body">
<script type="text/javascript">	var djConfig = { isDebug: true }; </script>
<script type="text/javascript" src="/zport/js/zenutils.js"></script>
<script type="text/javascript" 
        src="/zport/portal_skins/zenevents/zeneventsfuncs.js"></script>
<script type="text/javascript" src="/zport/portal_skins/zenmodel/datePicker.js">
</script>
<script type="text/javascript">
function datePickerClosed(targetInput) {
    if (targetInput.name == "startdate") {
        startdate = targetInput.value;
        enddateInput = targetInput.form.enddate;
    } else {
        startdate = targetInput.form.startdate.value;
        enddateInput = targetInput;
    } 
    var sdate = getFieldDate(startdate);
    var edate = getFieldDate(enddateInput.value);
    if (sdate.getTime() + 86400000 >= edate.getTime()) {
        edate = new Date(sdate.getTime() + 86400000);
        enddateInput.value = getDateString(edate);
    }
    return true;
};
</script>

<form method="post" tal:attributes="action here/absolute_url_path"
      name="history_events"
    tal:define="
    whereclause request/ev_whereclause | here/eventWhere | string:;
    orderby request/ev_orderby | here/eventOrderby | string:;
    resultFields request/ev_resultfields | here/getHistResultFields |
                    here/ZenEventHistory/defaultResultFields;
    evcontrol here/ZenEventHistory/eventControls;
    evcolspan python:len(resultFields)+2;
    severity request/severity | python:0;
    state request/state | python:2;
    sortedHeader request/sortedHeader | string:;
    page string:getHistoryEventListPage;
    ">


<tal:block tal:define="
tabletitle string:Event History;
menu_id string:HistoryEvent_list;
                      ">
<tal:block metal:use-macro="here/zenuimacros/macros/zentable">

<tal:block metal:fill-slot="filterslot">

<div style="position:absolute;right:50px;top:0px;z-index:2007;">
    <input type='hidden' name='table' value='history'/>
    Start Date: 
    <input class="tableheader" type="text" name="startdate" id="startdate"
		readonly="true"
        tal:attributes="value here/yesterdayDate"/>
    <input class="tableheader" type="button" value="select" 
        onclick="displayDatePicker('startdate');"/>
    End Date: 
    <input class="tableheader" type="text" name="enddate" id="enddate"
		readonly="true"
        tal:attributes="value here/todayDate"/>
    <input class="tableheader" type="button" value="select" 
        onclick="displayDatePicker('enddate');" />
    <input class="tableheader" type="submit" name="search" value=" Search " 
        onclick="getTablePage(this.form);return false;"/>
</div>
</tal:block>

<tal:block metal:fill-slot="zentablecontents">

<!-- BEGIN TABLE CONTENTS -->
    <tal:block metal:use-macro="here/viewEvents/macros/header"/>
    <tbody id="eventsBody">
        <span metal:use-macro="here/getHistoryEventListPage/macros/page"/>
    </tbody>
    <tal:block metal:define-macro="histeditor">
        <tr tal:condition="here/isManager">
            <td class="tableheader" tal:attributes="colspan evcolspan">
                <input class="tableheader" type="submit"
                    name="SelectButton" value="Select All"
                    onClick="toggleSelect(this.form); return false"/>
                            </td>
        </tr>
    </tal:block>
<!-- END TABLE CONTENTS -->

</tal:block>
</tal:block>
</tal:block>



</form>
</span>
</tal:block>
</tal:block>
