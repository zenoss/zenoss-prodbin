<tal:block metal:use-macro="here/templates/macros/page2">
<tal:block metal:fill-slot="contentPane">
<tal:block define="msie python:'MSIE' in here.REQUEST.HTTP_USER_AGENT">

<tal:block tal:condition="not:msie">
    <script src="/zport/js/MochiKit.js"></script>
    <script src="/zport/js/DragAndDrop.js"></script>
    <script src="/zport/js/Sortable.js"></script>
    <script src="zendragdrop.js"></script>
</tal:block>

<form method="post"
    tal:attributes="action string:${request/URL1}">
<input type="hidden" name="zenScreenName" tal:attributes="value template/id"/>

<tal:block tal:define="props here/zenPropertyIds;
                       tabletitle string:zProperties Configuration;">
<tal:block metal:use-macro="here/zenuimacros/macros/zentable">

<tal:block metal:fill-slot="zentablecontents">

<!-- BEGIN TABLE CONTENTS -->
    <tr>
      <th class="tableheader" align="center">Property</th>
      <th class="tableheader" align="center">Value</th>
      <th class="tableheader" align="center">Type</th>
      <th class="tableheader" align="center">Path</th>
    </tr>
    <tal:block tal:repeat="prop props"> 
    <tr tal:define="odd repeat/prop/odd"
        tal:attributes="class python:test(odd, 'odd', 'even')">
      <td class="tablevalues" tal:content="prop">
        zPingInterfaceRegex
      </td>
      <td class="tablevalues" tal:condition="not: here/isManager"
        tal:content="python: here.zenPropertyString(prop)"/>
      <td class="tablevalues" tal:condition="here/isManager"
        tal:define="ptype python:here.zenPropertyType(prop);
                    pvalue python:here.zenPropertyString(prop);
                    popts python:here.zenPropertyOptions(prop);">
            <span tal:condition="python: ptype=='boolean'">
                <select class="tablevalues" 
                    tal:attributes="name python:prop+':'+ptype">
                    <option tal:repeat="e python:(True,False)" tal:content="e"
                    tal:attributes="value e; selected python:e==pvalue"/>
                </select>
            </span>
	    <span tal:condition="python: ptype=='lines'">
		<tal:block tal:condition="python:msie or not popts">
		    <textarea class="tablevalues" rows='3' cols="33"
			tal:attributes="name python:prop+':'+ptype"
			tal:content="pvalue">
		    </textarea>        
		</tal:block>
		<!-- =========== swoopy sortable selector ============ -->
		<tal:block tal:condition="python:not msie and popts"
			   tal:define="propName python:prop+':'+ptype;
                                       ta python:'ta_' + prop;
				       ul python:'ul_' + prop;">
		  <div style="float:left;">
		    <textarea tal:content="pvalue" 
		              tal:attributes="name propName; id ta"/>
		    <h5>Plugins (drag to change order)</h5>
		  </div>
		  <div style="float:left;">
		    <ul tal:attributes="name propName; id ul"
		        class="sortable_list fieldlist">
		      <li class="sortable_item fieldlist"
			 tal:repeat="plugin python:
			 [x for x in popts if x not in here.zCollectorPlugins]"
			 tal:content="plugin"/>
		    </ul>
		    <h5>Available fields (drag to other list to add)</h5>
		  </div>
		  <script tal:content="
		          python:'''var x = new ZenDragDropList('%s', '%s');''' % (ta, ul)
                  "/> 
		<!-- =========== swoopy sortable selector =============== -->
		</tal:block>
	    </span>
            <span tal:condition="python: prop=='zEventSeverity'">
            <select class="tablevalues" 
                tal:attributes="name python:prop+':'+ptype">
                <option tal:repeat="sev here/dmd/getEventSeverities"
                    tal:content="python:sev[0]"
                    tal:attributes="value python:sev[1]; selected python:sev[1]==pvalue" />
            </select>
            </span>
            <span tal:condition="python: prop=='zFailSeverity'">
            <select class="tablevalues" 
                tal:attributes="name python:prop+':'+ptype">
                <option tal:repeat="sev here/dmd/ZenEventManager/getSeverities"
                    tal:content="python:sev[0]"
                    tal:attributes="value python:sev[1]; selected python:sev[1]==pvalue" />
            </select>
            </span>
            <span tal:condition="python: prop=='zEventAction'">
            <select class="tablevalues" 
                tal:attributes="name python:prop+':'+ptype">
                <option tal:repeat="a here/dmd/ZenEventManager/getEventActions"
                    tal:content="a"
                    tal:attributes="value a; selected python:a==pvalue" />
            </select>
            </span>
            <span tal:condition="python: ptype not in 'boolean lines text'.split() and prop not in 'zEventSeverity zEventAction zFailSeverity'.split()">
            <input class="tablevalues" type="text" size="40"
                tal:attributes="value pvalue;name python:prop+':'+ptype"/>
            </span>
      </td>
      <td class="tablevalues"
        tal:content="python: here.zenPropertyType(prop)"> 
        int
      </td>
      <td class="tablevalues" 
        tal:content="python: here.zenPropertyPath(prop)"> 
        /Devices/Servers
      </td>
    </tr>
    </tal:block>
    <tr class="tableheader" tal:condition="here/isManager">
    <td colspan="5">
        <input class="tableheader" type="submit" 
            name="saveZenProperties:method" value=" Save " />
    </td>
    </tr>
<!-- END TABLE CONTENTS -->

</tal:block>
</tal:block>
</tal:block>

</form>

<form tal:condition="here/isManager" method="post"
    tal:attributes="action string:${request/URL1}">
<input type="hidden" name="zenScreenName" tal:attributes="value template/id"/>


<tal:block tal:define="
tabletitle string:Delete Local Property;
                      ">
<tal:block metal:use-macro="here/zenuimacros/macros/zentable">

<!--==================== 
Optional titlebar stuff

<tal:block metal:fill-slot="menuslot">
</tal:block>
<tal:block metal:fill-slot="filterslot">
</tal:block>

  ====================-->

<tal:block metal:fill-slot="zentablecontents">

<!-- BEGIN TABLE CONTENTS -->
<tr class="tableheader">
    <td>
        <select name="propname" class="tableheader">
            <option tal:repeat="
                propname python:here.zenPropertyIds(False)"
                tal:content="propname" tal:attributes="value propname">
                    propname
            </option>
        </select>
        <input class="tableheader" type="submit" 
            name="deleteZenProperty:method" value=" Delete " />
    </td>
</tr>
<!-- END TABLE CONTENTS -->

</tal:block>
</tal:block>
</tal:block>

</form>

</tal:block>
</tal:block>
</tal:block>

