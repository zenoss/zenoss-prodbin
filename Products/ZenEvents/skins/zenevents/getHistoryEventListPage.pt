<tal:block metal:define-macro="page"
    tal:define="
        startdate request/startdate | here/yesterdayDate;
        enddate request/enddate | here/todayDate;
        severity request/severity | python:0;
        state request/state | python:2;
        objects python:here.getEventHistoryList(severity=severity,state=state,
                                        startdate=startdate,enddate=enddate);
        sortedHeader request/sortedHeader | string:;
        resultFields request/ev_resultfields | here/getHistResultFields | 
                        here/ZenEventHistory/defaultResultFields;
        filter request/filter | string:;
        evcolspan python:len(resultFields)+1;
        ztm here/ZenTableManager;
        objects python:ztm.filterObjects(objects,filter,resultFields);
        objects python:ztm.sortObjects(objects,request);
        batch python:ztm.getBatchForm(objects,request);"
        tal:on-error="structure here/eventsError">
    <tr tal:repeat="event batch" tal:attributes="class event/getCssClass">
    <tal:block tal:define="evclick 
        string:javascript:eventWindow('${event/zem}','${event/evid}')">
    <td tal:repeat="data python:event.getDataListWithLinks(resultFields)"
        tal:content="structure data">
        event data
    </td>
    <td tal:attributes="onclick evclick">
        <img tal:condition="python: event.eventState<=0" src="/zport/dmd/icon_details_magnify.gif" />
        <img tal:condition="python: event.eventState>0" src="/zport/dmd/icon_details_magnify_white.gif" />
    </td>
    </tal:block>
</tr>
<tr>
    <td class="tableheader" tal:attributes="colspan evcolspan">
        <span metal:use-macro=
            "here/zenTableNavigation/macros/navbodynofilter" />
    </td>
</tr>
</tal:block>
