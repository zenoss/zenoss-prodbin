<!-- ======================================================
    This page is used as the page-level templates
    and associated macros
 ====================================================== -->

<!-- ======================================================
    Page1 - page template that has slots for 
            breadCrumb and content 
 ====================================================== -->
<tal:block metal:define-macro="page1">
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" 
    "http://www.w3.org/TR/html4/loose.dtd">
<html>
    <head>
        <tal:block metal:use-macro="here/templates/macros/head1"/>
        <tal:block metal:define-slot="head-local"/>
        <tal:block metal:use-macro="here/zenuimacros/macros/jsutils"/>
    </head>
	<body>
    <tal:block metal:use-macro="here/dialogmacros/macros/proxyForm"/>
    <tal:block metal:use-macro="here/dialogmacros/macros/dialog_with_buttons"/>
	   <div id="frame">
            <form name="proxy_form" id="proxy_form"
                style="position:absolute;visibility:hidden"
                tal:attributes="action here/absolute_url_path"></form>
            <div metal:use-macro="here/templates/macros/topPane"/>
            <div id="infoBar">
                <div id="leftPaneToggle"></div>
                <div metal:define-slot="breadcrumbs" id="breadCrumbPane">
                   <span metal:use-macro="here/miscmacros/macros/breadCrumbs" />
                </div>
                <tal:block metal:use-macro="here/templates/macros/infoBarExtra"/>
            </div>
            <div id="paneToggle">
            </div>
            <style tal:condition="python:'Zenoss_Collapsed_Menu' in 
                                    here.REQUEST.HTTP_COOKIE">
                #leftPane { display:none;}
                #rightPane { margin-left:12px;}
                #paneToggle { 
                    display:none;
                    background-image: url('img/paneToggle_bg_collapsed.gif');
                    border-right: medium none;
                }
                #leftPaneToggle{ display:block;
                    background:transparent url('img/leftpanetoggle_bg.gif') top
                    left repeat-x;
                    height: 30px;
                    width: 30px;
                }
                #breadCrumbPane{ padding-left: 35px;}

            </style>
            <div metal:use-macro="here/leftPane/macros/leftPane"/>
	        <div id="rightPane">
                <tal:block metal:define-slot="rightPane">
                    <div id="contentPane">
                        <tal:block metal:define-slot="contentPane">
                            CONTENT GOES HERE
                        </tal:block>
                    </div>
                </tal:block>
            </div>
       </div>
    </body>
</html>
</tal:block>
                
                
<!-- ======================================================
    Pointer to new leftPane macro
 ====================================================== -->
<tal:block metal:define-macro="leftPane">
    <tal:block metal:use-macro="here/leftPane/macros/leftPane"/>
</tal:block>

<!-- ======================================================
    pageClean - page template that has none of the ornamentation
    of the regular templates
 ====================================================== -->
<tal:block metal:define-macro="pageClean">
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" 
    "http://www.w3.org/TR/html4/loose.dtd">
<html>
    <head>
        <tal:block metal:use-macro="here/templates/macros/head1"/>
        <tal:block metal:define-slot="head-local"/>
    </head>
	<body>
        <div id="contentPane">
            <tal:block metal:define-slot="contentPane">
                CONTENT GOES HERE
            </tal:block>
        </div>
    </body>
</html>
</tal:block>


<!-- ======================================================
    Page2 - page template that adds standard
        breadCrumb and nav tabs automatically
 ====================================================== -->
<tal:block metal:define-macro="page2">
    <html metal:use-macro="here/templates/macros/page1" >
        <tal:block metal:fill-slot="head-local">
        <tal:block metal:define-slot="head-local"/>
        </tal:block>
        <tal:block metal:fill-slot="breadcrumbs">
            <div id="breadCrumbPane">
            <tal:block metal:define-slot="breadcrumbs">
                   <span metal:use-macro="here/miscmacros/macros/breadCrumbs" />
            </tal:block>
            </div>
        </tal:block>
        <tal:block metal:fill-slot="rightPane">
            <div metal:use-macro="here/templates/macros/tabsPane"/>
            <div id="contentPane">
                <tal:block metal:define-slot="contentPane">
                        CONTENT GOES HERE
               </tal:block>
            </div>
        </tal:block>
    </html>
</tal:block>

<!-- ======================================================
    Page3 - page template with std BreadCrumbs and no tabs
 ====================================================== -->
<tal:block metal:define-macro="page3">
    <html metal:use-macro="here/templates/macros/page1" >
        <tal:block metal:fill-slot="rightPane">
            <div id="contentPane">
                <tal:block metal:define-slot="contentPane">
                        CONTENT GOES HERE
               </tal:block>
            </div>
        </tal:block>
    </html>
</tal:block>

<!-- ======================================================
    head1 - standard header
 ====================================================== -->
<tal:block metal:define-macro="head1">
    <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
    <title tal:content="string:Zenoss: ${here/getId}"/>
    <link rel="shortcut icon"
          href="/zport/dmd/favicon.ico"
          type="image/x-icon"/>
    <link rel="stylesheet" type="text/css" 
          href="yui/grids/grids-min.css"/>
    <link rel="stylesheet" type="text/css" title="zenoss"
        href="/zport/portal_skins/zenoss.css" >
    <link rel="stylesheet" type="text/css" title="zenoss"
        href="/zport/portal_skins/zenevents.css" >
    <link rel="stylesheet" type="text/css" title="zenoss"
        href="/zport/portal_skins/css/tables.css" >
    <link rel="stylesheet" type="text/css" title="zenoss"
        href="css/menus.css"/>
    <link rel="stylesheet" type="text/css" title="zenoss"
        href="css/dialog.css"/>
    <link rel="stylesheet" type="text/css" title="zenoss"
        href="css/filterbox.css"/>
    <link rel="stylesheet" type="text/css" title="zenoss"
        href="css/portlets.css"/>
    <!--[if IE 7]>
        <link rel="stylesheet" type="text/css" title="zenoss"
            href="zenoss_ie.css" >
    <![endif]-->
    <!--[if IE 6]>
        <link rel="stylesheet" type="text/css" title="zenoss"
            href="zenoss_ie6.css" >
    <![endif]-->
    <script type="text/javascript" src="js/MochiKit.js"></script>
    <script> var YAHOO_config={load:{base: '/zport/dmd/yui/'}};</script>
    <script type="text/javascript" language="javascript"
        src="/zport/dmd/yui/yahoo/yahoo-min.js"></script>
    <script type="text/javascript" language="javascript"
        src="/zport/dmd/yui/yuiloader/yuiloader-beta-min.js"></script>
    <script type="text/javascript" src="javascript/zenoss-core.js"></script>
    <script type="text/javascript" src="zenmodelfuncs.js"></script>
    <script type="text/javascript" src="javascript/selection.js"></script>
    <script type="text/javascript" src="js/zenui.js"></script>
    <script type="text/javascript" src="js/zenutils.js"></script>
    <script type="text/javascript" src="javascript/menus.js"></script>
    <script type="text/javascript" src="javascript/zgdagent.js"></script>


</tal:block>

<!-- ======================================================
    topPane - standard top area with logo, etc...
 ====================================================== -->
<div id="topPane" metal:define-macro="topPane">
    <div class="logo"
        tal:define="zenversion zenversion | string:Core"
        tal:content="string:| ${zenversion}">
        | Core
    </div>
    <div id="settings">
    <ul>
        <li>
        <span>
        <tal:block tal:content="request/AUTHENTICATED_USER"/>
        </span>
        </li>
        <li>
        <a tal:attributes="href here/dmd/ZenUsers/getUserSettingsUrl">
            Preferences</a>
        </li>
        <li>
        <a href="/zport/dmd/logoutUser">Logout</a>
        </li>
        <li>
        <a tal:attributes="href string:
            http://www.zenoss.com/help?version=${here/dmd/About/getZenossVersionShort}
        ">Help</a>
        </li>
    </ul>
    <div class="searchbox">
    <form action="/zport/dmd/deviceSearchResults" method="POST"
		name="searchform">
        <span class="searchform-label">Device/IP Search</span>
        <input type="text" name="query" 
            onkeypress="submitViaEnter(event)"
            onclick="select(this.value)"
            tal:attributes="value request/query | string:"/>
    </form> 
    </div>
    </div>
    <div id="system_clock_container">Zenoss server time: 
    <span id="system_clock">Now o'clock</span>
    <script tal:content="string: var start_time = '${here/server_time}';">
    var x;
    </script>
    <script>
    var timedelta = new Date().getTime() - isoTimestamp(start_time).getTime();
    var isIE//@cc_on=1;
    if (isIE) timedelta -= 25000;
    function updateTime(){
        var servernow = new Date(new Date().getTime() + timedelta);
        $('system_clock').innerHTML = toISOTime(servernow);
        callLater(1, updateTime);
    }
    addLoadEvent(updateTime);
    </script>
    </div>
</div>

<!-- ======================================================
    infoBar - second bar on the page, for breadcrumbs et al
 ====================================================== -->
<tal:block metal:define-macro="infoBarExtra">
<div id="messageSlot" style="{display: none;}"
	onclick="fade('messageSlot', {'duration':0.3} )" >
<div class="dbox_tl"><div class="dbox_tr"><div class="dbox_tc">
</div></div></div>
<div class="dbox_ml"><div class="dbox_mr"><div class="dbox_mc"
style="position:relative;">

<span id="messageSpan" 
		tal:content="python:here.REQUEST.get('message', '')">Message</span>

</div></div></div>
<div class="dbox_bl"><div class="dbox_br"><div class="dbox_bc">
</div></div></div>
</div>
<script>
	var initialMsg = '';
</script>
<script tal:condition="here/REQUEST/message|nothing"
		tal:content="structure string:
	initialMsg = '${here/REQUEST/message}';
	">
</script>
<script>
    var pulseMessage = function() {
        pulsate('messageSlot', {pulses:2, duration:3});
	}

    var hideMessage = function() {
        fade('messageSlot', {'duration':0.3} );
    }

	var showMessage = function(msg) {
		if (0 == msg.length) {
			hideElement('messageSlot');
		}
		else {			
			getElement('messageSpan').innerHTML = msg;
			showElement('messageSlot');
			pulseMessage();
		}
	}
	
	var showInitialMsg = function() {
		showMessage(initialMsg);
        callLater(15, hideMessage);
	}

	addLoadEvent(showInitialMsg);
</script>
</tal:block>
<!-- ======================================================
    BreadCrumbsPane
 ====================================================== -->
<div id="breadCrumbPane" metal:define-macro="breadCrumbPane"
    style="position:relative">
    <span metal:use-macro="here/miscmacros/macros/breadCrumbs" />
</div>

<!-- ======================================================
    tabsPane
 ====================================================== -->
<div id="tabsPane" metal:define-macro="tabsPane"
        tal:define="ztabs python:here.zentinelTabs(template.id);
                    tabnames python:[x['name'] for x in ztabs]">
   <table class="tabtable" cellpadding="0" cellspacing="0"
           tal:condition="python:(ztabs and not getattr(request, 'notabs', False))">
       <tr tal:define="menu_ids menu_ids |
           python:['More','Manage','Edit', 'Actions','Add','TopLevel']">
        <tal:block tal:condition="python:hasattr(here, 'getMenus')">
           <tal:block tal:define="hasMenus python:here.getMenus(menu_ids, here)">
        <td class="contextmenutab" 
            tal:condition="hasMenus">
        <span metal:use-macro="here/zenuimacros/macros/basemenu"/>
        </td>
        <td class="tabtableleftcap"
            tal:condition="not:hasMenus" >
        <div style="margin:0;padding:0;width:21px;">&nbsp;</div>
        </td>
        </tal:block>
        </tal:block>
        <tal:block tal:condition="python:not hasattr(here, 'getMenus')">
        <td class="tabtableleftcap">
        <div style="margin:0;padding:0;width:21px;">&nbsp;</div>
        </td>
        </tal:block>
           <td tal:repeat="tab ztabs"
               tal:attributes="class python:tab.get('selected', None) 
                                and 'tabletitleselected'">


    <tal:block tal:condition="python:tab.get('selected', None)">
    <div class="tablinehider"></div>
    <div class="tableft">
         <div class="tabright">
             <div class="tabcenter">
           <a class="tabletitle" tal:content="tab/name"
               tal:attributes="href python:
                   '%s/%s'% (here.absolute_url_path(),tab['action']);"
                >TabName</a>
             </div>
         </div>
     </div>
     </tal:block>
     <tal:block condition="python:not tab.get('selected', None)">
           <a class="tabletitle" tal:content="tab/name"
               tal:attributes="href python:
                   '%s/%s'% (here.absolute_url_path(),tab['action']);"
                >TabName</a>

     </tal:block>


           <div id="selectedtablinehider"
       tal:condition="python:tab.get('selected',None)">
           </div>

           </td>
        <td class='tabletitleselected'
            tal:condition="python:False">
           <div id="selectedtablinehider">
            Other Page
           </div>
        </td>
        <td class="tabtablecap">&nbsp;</td>
       </tr>
   </table>
</div>

<!-- ======================================================
     contentSeparator
 ====================================================== -->
<tal:block metal:define-macro="contentSeparator">
    <br/>
</tal:block>
