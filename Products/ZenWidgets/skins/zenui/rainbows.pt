<tal:block metal:define-macro="vertical"
    tal:on-error="structure python:here.dmd.error_handler(error)">
<tal:block tal:define="
    zem python:here.ZenEventManager;
    colors python:'red orange yellow blue grey green'.split();
    summaries python:zem.getEventSummaryME(here, 0);
    totals python:[x[2] for x in summaries];
    ackstatus python:[x[2]-x[1] for x in summaries];
    ">
    
    <div class="vertical-rainbow"
    onclick="location.href=YAHOO.zenoss.templateFreeURL+'/viewEvents'">
        <tal:block tal:repeat="evnum python:totals[:-1]">
        <div tal:define="color python:colors[repeat['evnum'].index]"
            tal:attributes="class string:evpill-${color}">
            <span tal:content="evnum">0</span>
            <div tal:condition="python:ackstatus[repeat['evnum'].index]<=0">
            </div>
        </div>
        </tal:block>
        <div class="evpill-green">
            <div tal:condition="python:filter(lambda x:x, 
                                              map(int, totals[:-1]))">
            </div>
        </div>
    </div>
</tal:block>
</tal:block>

<table width='100%' metal:define-macro="eventrainbow"
    tal:on-error="structure python:here.dmd.error_handler(error)"
    tal:define="
        default  python:1;
        severity severity | default">
    <tr>
        <td align=center width=16%
        tal:repeat="evt python:here.getEventSummary(severity=severity)"
        tal:attributes="class python:test(evt[1]-evt[2]>=0, 
                        evt[0]+' empty', evt[0])">
            <span tal:replace="python:'%d/%d' % (evt[1],evt[2])"/>
        </td>
  </tr>
</table>

<tal:block metal:define-macro="horizontal"
    tal:on-error="structure python:here.dmd.error_handler(error)">
<tal:block tal:define="
    zem python:here.ZenEventManager;
    colors python:'red orange yellow blue grey green'.split();
    summaries python:zem.getEventSummaryME(here, 0);
    totals python:[x[2] for x in summaries];
    ackstatus python:[x[2]-x[1] for x in summaries]; " >
    <div class="horizontal-rainbow"
    onclick="location.href=YAHOO.zenoss.templateFreeURL+'/viewEvents'">
        <tal:block tal:repeat="evnum python:totals[:-1]">
        <div tal:define="color python:colors[repeat['evnum'].index]"
            tal:attributes="class string:evpill-${color}"
            style="float:left">
            <span tal:content="evnum">0</span>
            <div tal:condition="python:ackstatus[repeat['evnum'].index]<=0">
            </div>
        </div>
        </tal:block>
        <div class="evpill-green" style="float:left">
            <div tal:condition="python:filter(lambda x:x, 
                                              map(int, totals[:-1]))">
            </div>
        </div>
    </div>
</tal:block>
</tal:block>
