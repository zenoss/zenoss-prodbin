<tal:block metal:use-macro="context/page_macros/masterdetail-new">
<tal:block metal:fill-slot="title">Event History</tal:block>

<tal:block metal:fill-slot="master_panel_content">
</tal:block>

<tal:block metal:fill-slot="detail_panel_content">
</tal:block>

<tal:block metal:fill-slot="script_beforeLayout">
<link rel="stylesheet"
    href="/++resource++zenui/js/livegrid/resources/css/ext-ux-livegrid.css"/>
<tal:block tal:content="structure provider:jssnippets"/>
<script>
Ext.state.Manager.setProvider(new Ext.state.CookieProvider({
    expires: new Date(new Date().getTime()+(1000*60*60*24*30))
}));
</script>
</tal:block>

<tal:block metal:fill-slot="script_layout">
<form id="exportform" method="post" action="export">
    <input type="hidden" id="export_body" name="body"/>
</form>
<!-- Template for rendering the detail pane -->
<textarea class="dontexpand" style="display:none" id="detail_table_template">
<table>
    <tr><td class="dt">Device:</td> 
        <td><tpl if="device"><a href="{device_url}" 
                class="resource-link">{device_title}</a></tpl></td>
        </tr>
    <tr><td class="dt">Component:</td> 
        <td><tpl if="component">
            <a href="{component_url}" 
                class="resource-link">{component_title}</a></tpl></td>
        </tr>
    <tr><td class="dt">Event Class:</td> 
        <td><tpl if="eventClass"><a href="{eventClass_url}"
                class="resource-link">{eventClass}</a></tpl></td>
        </tr>
    <tr><td class="dt">Status:</td> <td>{eventState}</td></tr>
    <tr><td class="dt">Start Time:</td> <td>{firstTime}</td></tr>
    <tr><td class="dt">Stop Time:</td> <td>{lastTime}</td></tr>
    <tr><td class="dt">Count:</td> <td>{count}</td></tr>
</table>
</textarea>
<textarea class="dontexpand" style="display:none" id="log_table_template">
    <table>
    <tpl for="log">
    <tr><td class="time">{1} {0} said: </td>
        <td class="message">{2}</td></tr>
    </tpl>
    </table>
</textarea>
<textarea class="dontexpand" style="display:none" id="fullprop_table_template">
<table class="proptable">
    <tpl for="properties">
    <tr class='{[xindex % 2 === 0 ? "even" : "odd"]}'>
        <td class="proptable_key">{key}</td>
        <td class="proptable_value">{value}</td></tr>
    </tpl>
</table>
</textarea>
<script tal:content="string:
    Ext.onReady(function(){
        Zenoss.env.EVENTSGRID_STATEID = 'histconsole';
    });
"></script>
<script src="/++resource++zenui/js/zenoss/EvHistory.js">
</script>
<script>
Ext.onReady(function(){
    var toolbar_items = [
        new Ext.Toolbar.Fill({}),
        new Zenoss.LiveGridInfoPanel({
            grid: 'events_grid'
        })
    ];

    Ext.each(toolbar_items, 
            function(item) {this.add(item);}, 
            Ext.getCmp('footer_bar'));
});
</script>
</tal:block>

</tal:block>
