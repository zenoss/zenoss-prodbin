 <tal:block metal:use-macro="here/templates/macros/page2">
  <tal:block metal:fill-slot="contentPane">
      
<tal:block condition="request/doDownload | nothing">
<tal:block tal:replace="structure string:<script type='text/javascript'>
var downloadUrl = '${here/absolute_url_path}/manage_download';
</script>" />
<script type="text/javascript">
function doDownloadRedirect(evt) {
    location.href = downloadUrl;
}
addLoadEvent(doDownloadRedirect);
</script>
</tal:block>

<form method="POST" tal:attributes="action here/absolute_url_path">
<input type="hidden" name="zenScreenName" tal:attributes="value template/id"/>

        <tal:block tal:define="tabletitle string:Metadata">
        <tal:block metal:use-macro="here/zenuimacros/macros/zentable">
        <tal:block metal:fill-slot="zentablecontents">
        <!-- BEGIN TABLE CONTENTS -->
            
    <tr>
        <td class="tableheader">Name</td>
        <td class="tablevalues" tal:content="here/id"/>
    </tr>
    <tr tal:condition="here/isEggPack">
        <td class="tableheader">Package</td>
        <td class="tablevalues" tal:content="here/moduleName"/>
    </tr>
    <tr>
        <td class="tableheader">Version</td>
        <td class="tablevalues" tal:condition="here/isDevelopment">
            <input class="tablevalues" type="text" name="version" size="40"
                tal:attributes="value here/version" />
        </td>
        <td class="tablevalues" tal:condition="not:here/isDevelopment"
            tal:content="here/version"/>
    </tr>
    <tr>
        <td class="tableheader">Author</td>
        <td class="tablevalues" tal:condition="here/isDevelopment">
            <input class="tablevalues" type="text" name="author" size="40"
                tal:attributes="value here/author" />
        </td>
        <td class="tablevalues" tal:condition="not:here/isDevelopment"
            tal:content="here/author"/>
    </tr>

    <tr tal:condition="here/isDevelopment">
        <td class="tableheader" colspan="2">
            <input class="tableheader" type="submit" value="Save"
                name="zmanage_editProperties:method" />
        </td>
    </tr>

        <!-- END TABLE CONTENTS -->

        </tal:block>
        </tal:block>
        </tal:block>



        <tal:block tal:define="tabletitle string:ZenPacks Required by ${here/id}"
            tal:condition="here/isEggPack">
        <br/>
        <tal:block metal:use-macro="here/zenuimacros/macros/zentable">
        <tal:block metal:fill-slot="zentablecontents">


    <tal:block tal:condition="here/isDevelopment"
        tal:define="eligibles here/getEligibleDependencies">
        <tr>
            <td class="tableheader" 
                tal:condition="here/isDevelopment">Required?</td>
            <td class="tableheader">Name</td>
            <td class="tableheader">Version(s)</td>
        </tr>
        <tr tal:repeat="pack eligibles">
            <td class="tablevalue">
                <input type="checkbox" name="dependencies" 
                    tal:attributes="
                        value pack/id;
                        checked python:here.dependencies.has_key(pack.id)" />
            </td>
            <td class="tablevalue" tal:content="pack/id" />
            <td class="tablevalue">
                <input class="tablevalues" type="text" size="40" 
                     tal:attributes="
                        value python:here.dependencies.get(pack.id, '');
                        name string:version_${pack/id}" />
            </td>
        </tr>
        <tr tal:condition="eligibles">
            <td class="tableheader" colspan="3">
                <input class="tableheader" type="submit" value="Save"
                    name="zmanage_editProperties:method" />
            </td>
        </tr>
        <tr tal:condition="not: eligibles">
            <td class="tablevalue" colspan="3">No other ZenPack eggs installed
            </td>
        </tr>
    </tal:block>
    <tal:block tal:condition="not: here/isDevelopment">
        <tr>
            <td class="tableheader">Name</td>
            <td class="tableheader">Version</td>
        </tr>
        <tr tal:repeat="name here/dependencies">
            <td class="tablevalue" tal:content="name" />
            <td class="tablevalue" tal:content="here/dependencies/name" />
        </tr>
        <tr tal:condition="not: here/dependencies">
            <td class="tablevalues" colspan="2">No dependencies</td>
        </tr>
    </tal:block>

        </tal:block>
        </tal:block>
        </tal:block>
<br/>
</form>


    <tal:block tal:define="tabletitle string:ZenPacks that Require ${here/id};
            filenames here/getDependentZenPacks;"
            tal:condition="here/isEggPack"
            >
    <tal:block metal:use-macro="here/zenuimacros/macros/zentable">
    <tal:block metal:fill-slot="zentablecontents"> 
    <!-- BEGIN TABLE CONTENTS -->
    <tal:block tal:repeat="filename here/getFilenames">
    <tr tal:define="odd repeat/filename/odd"
        tal:attributes="class python:test(odd, 'odd', 'even')">
       <td class="tablevalues" tal:content="filename"/>
    </tr>
    </tal:block>
    </tal:block>
    </tal:block>
    <br />
    </tal:block>


    <form method="post" name="zenPackObjectsForm" id="zenPackObjectsForm"
	  tal:attributes="action string:${here/absolute_url_path}"
	  tal:define="tableName string:packlistdetail;
		      objects here/packables;
		      batch python:container.dmd.ZenTableManager.getBatch(tableName,objects);">
      <input type="hidden" name="zenScreenName" 
	     tal:attributes="value template/id"/>
      <input type="hidden" name="tableName" tal:attributes="value tableName"/>
      
        
        <tal:block tal:define="tabletitle string:Objects in ZenPack; 
                               menu_id string:ZenPack;">
        <tal:block metal:use-macro="here/zenuimacros/macros/zentable">
        <tal:block metal:fill-slot="zentablecontents">
        <!-- BEGIN TABLE CONTENTS -->
        <tal:block tal:repeat="obj batch">
        <tr tal:define="odd repeat/obj/odd"
            tal:attributes="class python:test(odd, 'odd', 'even')">
           <td class="tablevalues">
              <input type="checkbox" name="packables:list" 
                 tal:attributes="value obj/getPrimaryUrlPath"/>
              <tal:block tal:content="structure 
                      python:obj.urlLink(text=obj.getPrimaryDmdId(),
                      attrs={'class':'tablevalues'})"/>
            </td>
        </tr>
        </tal:block>
        <tr tal:condition="not: batch">
            <td class="tablevalue">
                No database objects are included in this ZenPack
            </td>
        </tr>
        <tr>
          <td class="tableheader" align='center'>
            <span metal:use-macro="here/zenTableNavigation/macros/navbody"/>
          </td>
        </tr>
        <!-- END TABLE CONTENTS -->
        </tal:block>
        </tal:block>
        </tal:block>
    </form>
    <br />

    <tal:block tal:define="tabletitle string:Objects Requiring this ZenPack;
        tableName string:zenpackcatalogedobjects;
        objects here/getCatalogedObjects;
        batch
        python:container.dmd.ZenTableManager.getBatch(tableName,objects);">
    <tal:block metal:use-macro="here/zenuimacros/macros/zentable">
    <tal:block metal:fill-slot="zentablecontents"> 
    <tal:block tal:repeat="obj batch">
    <tr tal:define="odd repeat/obj/odd"
        tal:attributes="class python:test(odd, 'odd', 'even')">
       <td class="tablevalues" tal:content="
           structure
           python:obj.urlLink(text=obj.getPrimaryDmdId(),
           attrs={'class':'tablevalues'})"/>
    </tr>
    </tal:block>
    <tr tal:condition="not: objects">
        <td class="tablevalue">
            No objects require this ZenPack
        </td>
    </tr>
        <tr>
          <td class="tableheader" align='center'>
            <span metal:use-macro="here/zenTableNavigation/macros/navbody"/>
          </td>
        </tr>
    </tal:block>
    </tal:block>
    </tal:block>
    <br />

    <tal:block tal:define="tabletitle string:Files in ZenPack;
            filenames here/getFilenames;">
    <tal:block metal:use-macro="here/zenuimacros/macros/zentable">
    <tal:block metal:fill-slot="zentablecontents"> 
    <!-- BEGIN TABLE CONTENTS -->
    <tal:block tal:repeat="filename here/getFilenames">
    <tr tal:define="odd repeat/filename/odd"
        tal:attributes="class python:test(odd, 'odd', 'even')">
       <td class="tablevalues" tal:content="filename"/>
    </tr>
    </tal:block>

    <!-- END TABLE CONTENTS -->
    </tal:block>
    </tal:block>
    </tal:block>
    <br />

  </tal:block>
</tal:block>
